
–î–ª—è –Ω–∞—á–∞–ª–∞ –∑–∞—Ö–æ–¥–∏–º –≤ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ SSH:
<pre><code class="language-javascript">
ssh root@176.214.14.203 // ip —Å–µ—Ä–≤–µ—Ä–∞
–í–≤–æ–¥–∏–º –ø–∞—Ä–æ–ª—å –∏ –ø–æ–ø–∞–¥–∞–µ–º –≤ –û–° —Å–µ—Ä–≤–µ—Ä–∞
</code></pre>
–ß—Ç–æ –Ω–∞–º –∑–¥–µ—Å—å –Ω–∞–¥–æ –¥–∞–ª—å—à–µ. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Node.js –∏ –µ—Å–ª–∏ –Ω–µ—Ç —Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å.
<pre><code class="language-javascript">
node -v // –µ—Å–ª–∏ –ø–æ–∫–∞–∂–µ—Ç –∑–Ω–∞—á–∏—Ç –Ω–æ–¥–∞ —Å—Ç–æ–∏—Ç. –ï—Å–ª–∏ –Ω–µ—Ç
//–î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 20.x):
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
//–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Node.js (npm —Å—Ç–∞–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):
sudo apt install -y nodejs
//–ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É
node -v
npm -v
//–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –≤–µ—Ä—Å–∏–∏ Node.js –∏ npm
//–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º PM2 –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –Ω–æ–¥—ã
sudo npm install -g pm2
</code></pre>
–¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å—Ç–∏–º –Ω–∞—à–µ –Ω–æ–¥–µ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –£ –º–µ–Ω—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ - app.js
–î–ª—è –±–æ–µ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ–º —á–µ—Ä–µ–∑ "node app.js" –Ω–∞–ø—Ä—è–º—É—é, –∏–Ω–∞—á–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ SSH –ø—Ä–æ—Ü–µ—Å—Å —É–º—Ä—ë—Ç. –ò—Å–ø–æ–ª—å–∑—É—é–µ–º pm2:
<pre><code class="language-javascript">
pm2 start app.js --name "nodesite"
pm2 save
pm2 startup //–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ.
</code></pre>
–î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –∫—Ä–∞—Å–∏–≤–∞—è —Ç–∞–±–ª–∏—á–∫–∞ –≥–¥–µ –±—É–¥–µ—Ç –∑–µ–ª—ë–Ω—ã–º –≥–æ—Ä–µ—Ç—å online)

–ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –¥–æ–º–µ–Ω –∏–ª–∏ –ø–æ–¥–¥–æ–º–µ–Ω –∏–¥—É—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –Ω–∞ nginx 80–π –ø–æ—Ä—Ç. –ù—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –∏—Ö –Ω–∞ Node.js. –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–ª—Å—è —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥–æ–≤ –¥–æ–º–µ–Ω–∞, –Ω–µ –ø–æ–ª—É—á–∞–ª–æ—Å—å, –ø—Ä–∏—à–ª–æ—Å—å –ª–µ–∑—Ç—å –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ nginx. –û—Ç–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–∞–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É nano. –í Ubuntu –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ Nginx –æ–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –ø—É—Ç–∏: /etc/nginx/nginx.conf. –ß—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ:
<pre><code class="language-javascript">
sudo nano /etc/nginx/nginx.conf
–∏–ª–∏ —á–µ—Ä–µ–∑ vim:
sudo vim /etc/nginx/nginx.conf
</code></pre>
–í–æ—Ç —á—Ç–æ —Ç–∞–º –±—ã–ª–æ –¥–ª—è –º–æ–µ–≥–æ –ø–æ–¥–¥–æ–º–µ–Ω–∞:
<pre><code class="language-javascript">
server {
  server_name node.waytohome.in.net www.node.waytohome.in.net;
  listen 176.114.14.200;
  disable_symlinks if_not_owner from=$root_path;
  set $root_path /var/www/sash30038383/data/www/node.waytohome.in.net;
  location ~* ^.+\.(jpg|jpeg|gif|png|svg|js|css|mp3|ogg|mpe?g|avi|zip|gz|bz2?|rar|swf)$ {
    root $root_path;
    access_log /var/www/nginx-logs/sash30038383 isp;
    access_log /var/www/httpd-logs/node.waytohome.in.net.access.log ;
    error_page 404 = @fallback;
  }
  location / {
    proxy_pass http://176.114.14.200:81;
    proxy_redirect http://176.114.14.200:81/ /;
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Real-IP $remote_addr;
  }
  location ~* ^/(webstat|awstats|webmail|myadmin|pgadmin)/ { //–∏ –¥–∞–ª—å—à–µ –±–ª–æ–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è server
  }
}
</code></pre>
–ó–∞–º–µ–Ω–∏–ª –≤–µ—Å—å —ç—Ç–æ—Ç –±–ª–æ–∫ –Ω–∞
<pre><code class="language-javascript">
# --- –ü–æ–¥–¥–æ–º–µ–Ω Node.js ---
server {
  listen 176.114.14.200:80;  # —Ç–≤–æ–π IP —Å–µ—Ä–≤–µ—Ä–∞
  server_name node.waytohome.in.net www.node.waytohome.in.net;

  # –ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞ –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
  set $root_path /var/www/sash30038383/data/www/node.waytohome.in.net/public;

  # –û—Ç–¥–∞—ë–º —Å—Ç–∞—Ç–∏–∫—É –Ω–∞–ø—Ä—è–º—É—é
  location ~* ^.+\.(jpg|jpeg|gif|png|svg|js|css|mp3|ogg|mpe?g|avi|zip|gz|bz2?|rar|swf)$ {
      root $root_path;
      access_log /var/www/nginx-logs/sash30038383 isp;
      access_log /var/www/httpd-logs/node.waytohome.in.net.access.log;
      error_page 404 = @fallback;
  }

  # –ü—Ä–æ–∫—Å–∏—Ä—É–µ–º –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –Ω–∞ Node.js
  location / {
      proxy_pass http://127.0.0.1:4320;
      proxy_http_version 1.1;
      proxy_set_header Host $host;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto $scheme;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection "upgrade";
  }

  # –ü—Ä–∏–º–µ—Ä –∑–∞—â–∏—Ç—ã /webstat
  location ^~ /webstat/ {
      auth_basic "Restricted area";
      auth_basic_user_file /var/www/sash30038383/data/etc/534771.passwd;
      try_files $uri @fallback;
  }

  # fallback –¥–ª—è –æ—à–∏–±–æ–∫ 404
  location @fallback {
      proxy_pass http://127.0.0.1:4320;
      proxy_set_header Host $host;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto $scheme;
  }

  # –í–∫–ª—é—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ISPmanager
  include /usr/local/ispmgr/etc/nginx.inc;
}

</code></pre>
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å nginx, –Ω–æ–¥–∞ —É –Ω–∞—Å –∑–∞–ø—É—â–µ–Ω–∞ —Å–ª—É—à–∞–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç (—É –º–µ–Ω—è 4320)
<pre><code class="language-javascript">
sudo nginx -t # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo systemctl reload nginx //–∏–ª–∏
sudo systemctl restart nginx
</code></pre>
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—Å—ë –æ—Ç–∫—Ä—ã–ª–æ—Å—å —É –º–µ–Ω—è, –¥–∞–π –ë–æ–≥ –∏ —É –≤–∞—Å —Å—Ä–∞–±–æ—Ç–∞–µ—Ç üòäü§ù

–¢–µ–ø–µ—Ä—å —Å–¥–µ–ª–∞–µ–º –±–æ–µ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥ PM2, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö–æ—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º, —Ö–æ—Ç—å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ. –°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª ecosystem.config.js –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
<pre><code class="language-javascript">
module.exports = {
  apps: [
    {
      name: "myapp",              // –∏–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ª—é–±–æ–µ)
      script: "app.js",           // —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (–∏–ª–∏ server.js)
      instances: 1,               // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (1 = –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º)
      autorestart: true,          // –∞–≤—Ç–æ-—Ä–µ–±—É—Ç –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
      watch: true,               // —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Ñ–∞–π–ª–∞–º–∏ (–ª—É—á—à–µ false –Ω–∞ –ø—Ä–æ–¥–µ)
      watch_delay: 1000, // –∑–∞–¥–µ—Ä–∂–∫–∞ —á—Ç–æ–±—ã –Ω–µ –¥–µ—Ä–≥–∞–ª—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
      max_memory_restart: "300M", // –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –µ—Å–ª–∏ >300–ú–ë –ø–∞–º—è—Ç–∏
      max_memory_restart: "300M", // –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –µ—Å–ª–∏ >300–ú–ë –ø–∞–º—è—Ç–∏
      env: {
      NODE_ENV: "development",  // –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è dev
    },
    env_production: {
      NODE_ENV: "production"    // –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è prod
    },
      error_file: "./logs/err.log",  // –æ—à–∏–±–∫–∏
      out_file: "./logs/out.log",    // –æ–±—ã—á–Ω—ã–µ –ª–æ–≥–∏
      log_date_format: "YYYY-MM-DD HH:mm:ss"
    }
  ]
};
</code></pre>
–ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

pm2 start ecosystem.config.js --env production --watch  # –∑–∞–ø—É—Å–∫

üî∏ –ï—Å–ª–∏ —Ä—É–≥–∞–µ—Ç—Å—è –ó–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ npx. –¢–æ–≥–¥–∞ PowerShell –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç .ps1:

npx pm2 start ecosystem.config.js --env production --watch
npx pm2 restart myapp  # –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
npx pm2 stop myapp     # —Å—Ç–æ–ø
npx pm2 delete myapp   # —É–¥–∞–ª–∏—Ç—å
npx pm2 logs myapp     # —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
npx pm2 monit          # –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –∫–æ–Ω—Å–æ–ª–∏

–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (—á—Ç–æ–±—ã –ø–æ—Å–ª–µ —Ä–µ–±—É—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ –≤—Å—ë —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª–æ)
pm2 save
pm2 startup

üì¶ –í –∏—Ç–æ–≥–µ —É –Ω–∞—Å –±—É–¥–µ—Ç:
–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ Node.js
–ê–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ–µ –∏–ª–∏ —É—Ç–µ—á–∫–µ –ø–∞–º—è—Ç–∏
–ö—Ä–∞—Å–∏–≤—ã–µ –ª–æ–≥–∏ –≤ ./logs/
–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ª—ë–≥–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –æ–¥–Ω—É –∫–æ–º–∞–Ω–¥—É

